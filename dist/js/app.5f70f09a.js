(function(){"use strict";var t={3207:function(t,e,n){var s=n(9242),o=n(3396),r=n(4870),a=n(2483),u={__name:"App",setup(t){return(t,e)=>((0,o.wg)(),(0,o.j4)((0,r.SU)(a.MA)))}};const i=u;var l=i,c=n(7139);const p={class:"page"},d=["textContent"];var f={__name:"Page",props:{title:String},setup(t){return(e,n)=>((0,o.wg)(),(0,o.iD)("div",p,[t.title?((0,o.wg)(),(0,o.iD)("h2",{key:0,class:"page__title",textContent:(0,c.zw)(t.title)},null,8,d)):(0,o.kq)("",!0),(0,o.WI)(e.$slots,"default")]))}};const m=f;var _=m;const g={class:"page__block"},v=["textContent"];var w={__name:"PageBlock",props:{subtitle:String},setup(t){return(e,n)=>((0,o.wg)(),(0,o.iD)("div",g,[t.subtitle?((0,o.wg)(),(0,o.iD)("h3",{key:0,class:"page__subtitle",textContent:(0,c.zw)(t.subtitle)},null,8,v)):(0,o.kq)("",!0),(0,o.WI)(e.$slots,"default")]))}};const h=w;var y=h;n(6699);function b(t,e){let n=null;return function(){clearTimeout(n),n=setTimeout((()=>t.apply(this,arguments)),e)}}function k(t,e){let n=null;return function(){return clearTimeout(n),new Promise((s=>{n=setTimeout((()=>{t.apply(this,arguments).then((t=>s(t)))}),e)}))}}function D(...t){return t.reduce(((t,e)=>t.filter((t=>e.includes(t)))))}function j(t,e,n){var s,o=new Date,r=new Date(o.getFullYear(),o.getMonth(),o.getDate()),a=new Date(t,e,n),u=new Date(r.getFullYear(),a.getMonth(),a.getDate());return s=r.getFullYear()-a.getFullYear(),r<u&&(s-=1),s}function x(...t){return t.map((t=>(0,r.dq)(t)?t.value:t))}const L=["value"];var S={__name:"CustomInput",props:{value:String},emits:["input"],setup(t,{emit:e}){return(e,n)=>((0,o.wg)(),(0,o.iD)("input",{value:t.value,ref:"input",type:"text",onInput:n[0]||(n[0]=t=>e.$emit("input",t.target.value))},null,40,L))}};const H=S;var U=H;const $=(0,r.iH)([]),C=(0,r.iH)([]),W=(0,r.qj)({}),O=(0,r.iH)([]),P=(0,r.iH)([]),Y={class:"panel"};function E(t,e){return(0,o.wg)(),(0,o.iD)("div",Y,[(0,o.WI)(t.$slots,"default")])}var F=n(89);const q={},I=(0,F.Z)(q,[["render",E]]);var z=I;const B={class:"loader"},N={class:"loader__anim"},M=(0,o._)("div",{class:"lds-dual-ring"},null,-1),T=[M];var A={__name:"LoadingView",props:{isLoading:{type:Boolean,default:!0}},setup(t){return(e,n)=>((0,o.wg)(),(0,o.iD)("div",B,[(0,o.wy)((0,o._)("div",N,T,512),[[s.F8,t.isLoading]]),(0,o.WI)(e.$slots,"default")]))}};const K=A;var R=K;function Z(t){const e=t??(0,r.iH)(!1),n=()=>e.value=!0,s=()=>e.value=!1;return{isLoading:e,onLoad:s,onBeforeLoad:n}}const J=["src","alt","onload"],Q={class:"user-panel__data"},V={class:"user-panel__name"};var G={__name:"UserPanel",props:{user:Object},setup(t){const{isLoading:e,onLoad:n}=Z();return(s,a)=>((0,o.wg)(),(0,o.j4)(z,{class:"user-panel"},{default:(0,o.w5)((()=>[(0,o.Wm)(R,{class:"user-panel__image-cont",isLoading:(0,r.SU)(e)},{default:(0,o.w5)((()=>[(0,o._)("img",{src:t.user.photo_50,alt:`${t.user.fullName} - Аватар`,onload:(0,r.SU)(n)},null,8,J)])),_:1},8,["isLoading"]),(0,o._)("div",Q,[(0,o._)("span",V,(0,c.zw)(t.user.fullName),1),(0,o.WI)(s.$slots,"default")])])),_:3}))}};const X=G;var tt=X;function et(t){t.id in W?delete W[t.id]:W[t.id]=t}function nt(t){return(0,o.Fl)((()=>t in W))}var st={__name:"UserCard",props:{user:Object},setup(t){const e=t,n=nt(e.user.id);return(e,s)=>((0,o.wg)(),(0,o.j4)(tt,{user:t.user,class:(0,c.C_)({_active:(0,r.SU)(n)}),onMousedown:s[0]||(s[0]=e=>(0,r.SU)(et)(t.user))},null,8,["user","class"]))}};const ot=st;var rt=ot;const at={class:"user-list"};var ut={__name:"UsersList",setup(t){return(t,e)=>((0,o.wg)(),(0,o.iD)("ul",at,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,r.SU)($),(t=>((0,o.wg)(),(0,o.iD)("li",{key:t.id,class:"user-list__item"},[(0,o.Wm)(rt,{user:t},null,8,["user"])])))),128))]))}};const it=ut;var lt=it;const ct="vk1.a.RsNQP-lSUZzwGzCBEaj4tuRMTxIoSWjfckB7lLPJ6gVgzL-ZrZ11fOd72byPXIYpZTe5aSkxj7I6vCdQxTjmiPlBgaHO3Z35j874a8QyAw7iyGb0iIER2v4iR2Ou_lIOb-S3mCTwK0drzCJJZkJmcntp0FqHyJQDQkSK9m2m6-UAVEMjUO6Rbswa8R8P4aXn",pt="http://localhost:8010/proxy",dt=5.131,ft=5;function mt(t,e){e={...e,count:ft,access_token:ct,v:dt};const n=Object.entries(e),s=n.map((t=>t.join("="))).join("&");return`${pt}/${t}?${s}`}function _t(t){const e={0:"Не указан",1:"Женский",2:"Мужской"};if("bdate"in t){const[e,n,s]=t.bdate.split("."),o=j(s,n,e);delete t.bdate,t.age=o}"first_name"in t&&"last_name"in t&&(t.fullName=`${t.first_name} ${t.last_name}`),"sex"in t&&(t.sex=e[t.sex]),"counters"in t&&"friends"in t.counters&&(t.friends_count=t.counters.friends,delete t.counters.friends)}async function gt(t,e=0){const n=mt("users.search",{q:t,offset:e,fields:"photo_50"}),s=await fetch(n),o=await s.json();return o.response.items.forEach((t=>_t(t))),{response:o.response.items,count:o.response.count}}var vt=async(t,e=0)=>{const{response:n,count:s}=await gt(t,e);return 0===e?($.value=n,Se.push({path:"/",query:{search:t}})):$.value=[...$.value,...n],{count:s}};const wt=".page";function ht(t,e,...n){let s;const a=5,u=(0,r.iH)(0),i=(0,r.iH)(a);function l(){if(!1===e.value&&u.value>a){const o=Math.floor(s.getBoundingClientRect().bottom);if(o<=window.innerHeight){e.value=!0,i.value+=a;const s=x(...n,i);t(...s).then((t=>{u.value=t.count,e.value=!1}))}}}return(0,o.bv)((()=>{s=document.querySelector(wt),window.addEventListener("scroll",l)})),(0,o.Ah)((()=>{window.removeEventListener("scroll",l)})),{offset:i,count:u,step:a}}var yt={__name:"UsersSearch",setup(t){const e=(0,a.yj)(),{isLoading:n,onLoad:s,onBeforeLoad:u}=Z(),i=(0,r.iH)(e.query.search),{step:l,count:c,offset:p}=ht(vt,n,i);(0,o.m0)((()=>{i.value=e.query.search,p.value=l,i.value&&(u(),vt(i.value).then((t=>{c.value=t.count,s()})))}));const d=b(Se.replace,1e3);function f(t){u(),d({query:{search:t}})}return(t,e)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(U,{value:t.$route.query.search,type:"text",class:"input",onInput:f},null,8,["value"]),(0,o.Wm)(lt),(0,o.Wm)(R,{style:{"margin-top":"2em"},isLoading:(0,r.SU)(n)},null,8,["isLoading"])],64))}};const bt=yt;var kt=bt;const Dt=["textContent"];var jt={__name:"UserCounter",setup(t){const e=(0,o.Fl)((()=>`Добавлено: ${Object.keys(W).length}`));function n(){for(const t in W)delete W[t]}return(t,s)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",{class:"counter",textContent:(0,c.zw)((0,r.SU)(e))},null,8,Dt),(0,o._)("button",{class:"button",type:"button",onClick:n},"Очистить")],64))}};const xt=jt;var Lt=xt;const St=(0,o.Uk)("Построить");var Ht={__name:"HomePage",setup(t){const e={display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1em"};return(t,n)=>((0,o.wg)(),(0,o.j4)(_,{title:"Поиск"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{style:e},{default:(0,o.w5)((()=>[(0,o.Wm)(Lt),(0,o.Wm)((0,r.SU)(a.rH),{to:"/friends",class:"link"},{default:(0,o.w5)((()=>[St])),_:1})])),_:1}),(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(kt)])),_:1})])),_:1}))}};const Ut=Ht;var $t=Ut;const Ct={min:1,max:1},Wt=t=>`rgba(73, 127, 235, ${t})`;function Ot(t){if(Ct.min==Ct.max)return Wt(1);const e=C.value.find((e=>e.id==t)).count,n=(e-Ct.min)/2/(Ct.max-Ct.min)+.5;return Wt(n)}(0,o.YP)(C,(t=>{const e=t.map((t=>t.count));Ct.min=Math.min(...e),Ct.max=Math.max(...e)}));const Pt={class:"user-panel__info user-info"},Yt={key:0,class:"user-info__item"};var Et={__name:"UserDetail",props:{user:Object},setup(t){const e=t,n=(0,r.iH)("");return(0,o.bv)((()=>n.value=Ot(e.user.id))),(e,s)=>((0,o.wg)(),(0,o.j4)((0,r.SU)(a.rH),{to:{path:`/friends/${t.user.id}`}},{default:(0,o.w5)((()=>[(0,o.Wm)(tt,{user:t.user,style:(0,c.j5)({backgroundColor:n.value,color:"#fff"})},{default:(0,o.w5)((()=>[(0,o._)("ul",Pt,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)({sex:"Пол",age:"Возраст",friends_count:"Кол-во друзей"},((e,n)=>((0,o.wg)(),(0,o.iD)(o.HY,{key:t.user.id+n},[t.user[n]?((0,o.wg)(),(0,o.iD)("li",Yt,[(0,o._)("span",null,(0,c.zw)(e),1),(0,o._)("span",null,(0,c.zw)(t.user[n]),1)])):(0,o.kq)("",!0)],64)))),64))])])),_:1},8,["user","style"])])),_:1},8,["to"]))}};const Ft=Et;var qt=Ft;function It(t){const e=[[]];return t.forEach((t=>{const n=e[e.length-1];n.length<25?n.push(+t):e.push([+t])})),e}function zt(t){return t.length?t.reduce(((t,e)=>{const n=[];return t.forEach((t=>{const s=e.find((e=>t.id===e.id&&!D(t.sources,e.sources).length)),o=[...t.sources,...s?s.sources:[]];n.push({id:t.id,sources:o,count:o.length})})),n})):t}function Bt(t){const e=t.map((t=>t.response)).flat().filter((t=>!!t));if(!e.length)return[];const n=e.map((t=>zt(t.map((t=>t.common_friends.map((e=>({id:e,sources:[t.id],count:1})))))))),s=zt(n);return s}async function Nt(t){const e=[];if(1===t.length)return[];const n=It(t),s=n.map((t=>{const e=t.map((e=>{const n=t.filter((t=>t!==e)).join(",");return`API.friends.getMutual({"source_uid":${e},"target_uids": "${n}"})`})).toString();return`return [${e}];`}));s.forEach((t=>{const n=mt("execute",{code:t}),s=fetch(n).then((t=>t.json()));e.push(s)}));const o=await Promise.all(e),r=Bt(o);return console.log(r),r}var Mt=k((async t=>{C.value=await Nt(t)}),500);async function Tt(t){const e=[],n=It(t),s=n.map((t=>{const e=t.map((t=>`API.users.get({"user_ids":"${t}","fields": "bdate,sex,counters,photo_50"})`)).toString();return`return [${e}];`}));s.forEach((t=>{const n=mt("execute",{code:t}),s=fetch(n).then((t=>t.json()));e.push(s)}));const o=await Promise.all(e),r=o.map((t=>t.response)).flat(2);return r.forEach((t=>_t(t))),r.sort(((t,e)=>t.fullName<e.fullName?-1:t.fullName>e.fullName?1:void 0)),r}var At=async t=>P.value=await Tt(t);const{isLoading:Kt,onBeforeLoad:Rt,onLoad:Zt}=Z();(0,o.YP)((()=>({...W})),(t=>{Rt();const e=Object.keys(t);Mt(e)})),(0,o.YP)(C,(t=>{const e=t.map((t=>t.id));At(e).then((()=>Zt()))}));const Jt={key:0,class:"user-list"},Qt={key:1};var Vt={__name:"FriendsList",setup(t){return(t,e)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,r.SU)(P).length&&!(0,r.SU)(Kt)?((0,o.wg)(),(0,o.iD)("ul",Jt,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,r.SU)(P),(t=>((0,o.wg)(),(0,o.iD)("li",{key:t.id,class:"user-list__item"},[(0,o.Wm)(qt,{user:t},null,8,["user"])])))),128))])):(0,r.SU)(Kt)?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("h3",Qt,"У выбранных пользователей нет общих друзей!")),(0,o.Wm)(R,{isLoading:(0,r.SU)(Kt)},null,8,["isLoading"])],64))}};const Gt=Vt;var Xt=Gt,te={__name:"FriendsPage",setup(t){return(t,e)=>((0,o.wg)(),(0,o.j4)(_,{title:"Общие друзья"},{default:(0,o.w5)((()=>[(0,o.Wm)(Xt)])),_:1}))}};const ee=te;var ne=ee;const se=["href"],oe=["textContent"],re={key:1,class:"post__attachments"},ae=["src"],ue=["textContent"],ie={class:"post__info post-info"},le=["textContent"];var ce={__name:"PostCard",props:{post:Object},setup(t){return(e,n)=>((0,o.wg)(),(0,o.j4)(z,null,{default:(0,o.w5)((()=>[(0,o._)("a",{class:"post",href:t.post.url},[t.post.text?((0,o.wg)(),(0,o.iD)("p",{key:0,textContent:(0,c.zw)(t.post.text),class:"post__text"},null,8,oe)):(0,o.kq)("",!0),t.post.attachments?((0,o.wg)(),(0,o.iD)("ul",re,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.post.attachments,(e=>((0,o.wg)(),(0,o.iD)("li",{key:t.post.id+e.type,class:"post__attachment"},["photo"==e.type?((0,o.wg)(),(0,o.iD)("img",{key:0,src:e.item.url,class:"post__image"},null,8,ae)):"audio"==e.type?((0,o.wg)(),(0,o.iD)("div",{key:1,textContent:(0,c.zw)(e.item)},null,8,ue)):(0,o.kq)("",!0)])))),128))])):(0,o.kq)("",!0),(0,o._)("ul",ie,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(["comments","likes","views","reposts"],(e=>((0,o.wg)(),(0,o.iD)(o.HY,{key:t.post.id+e},[t.post[e]?((0,o.wg)(),(0,o.iD)("span",{key:0,textContent:(0,c.zw)(t.post[e]),class:"post-info__item"},null,8,le)):(0,o.kq)("",!0)],64)))),64))])],8,se)])),_:1}))}};const pe=ce;var de=pe;function fe(t){t.url=`https://vk.com/?w=wall${t.owner_id}_${t.id}%2Fall`,"likes"in t&&(t.likes=`❤️ ${t.likes.count}`),"views"in t&&(t.views=`👁️ ${t.views.count}`),"comments"in t&&(t.comments=`💬 ${t.comments.count}`),"reposts"in t&&(t.reposts=`🔗 ${t.reposts.count}`),"attachments"in t&&(t.attachments=t.attachments.map((t=>{switch(t.type){case"photo":const e=t.photo.sizes.slice(-3,-2)[0];return{type:"photo",item:e};case"audio":const n=`🎵 ${t.audio.artist} — ${t.audio.title}`;return{type:"audio",item:n};default:return t}})))}async function me(t,e){const n=mt("wall.get",{owner_id:t,offset:e}),s=await fetch(n),o=await s.json(),r=o.response.items;return r.forEach((t=>fe(t))),{response:r,count:o.response.count}}var _e=async(t,e=0)=>{const{response:n,count:s}=await me(t,e);return O.value=[...O.value,...n],console.log(O.value),{count:s}};const ge={class:"posts-list"};var ve={__name:"PostsList",props:{id:Number},setup(t){const e=t,{isLoading:n,onLoad:s,onBeforeLoad:a}=Z();(0,o.bv)(a);const{count:u}=ht(_e,n,e.id);return(0,o.bv)((async()=>{u.value=(await _e(e.id)).count,s()})),(t,e)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("ul",ge,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,r.SU)(O),(t=>((0,o.wg)(),(0,o.iD)("li",{key:t.id,class:"posts-list__item"},[(0,o.Wm)(de,{post:t},null,8,["post"])])))),128))]),(0,o.Wm)(R,{style:{"margin-top":"2em"},isLoading:(0,r.SU)(n)},null,8,["isLoading"])],64))}};const we=ve;var he=we;function ye(){const t=+(0,a.yj)().params.id,e=(0,o.Fl)((()=>{const e=C.value.find((e=>e.id===t)).sources,n=e.map((t=>W[t]));return n}));return{id:t,commonFriends:e}}const be={class:"user-list"};var ke={__name:"FriendPage",setup(t){const{id:e,commonFriends:n}=ye();return(t,s)=>((0,o.wg)(),(0,o.j4)(_,{title:"Информация"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{subtitle:"В друзьях у:"},{default:(0,o.w5)((()=>[(0,o._)("ul",be,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,r.SU)(n),(t=>((0,o.wg)(),(0,o.iD)("li",{key:t.id,class:"user-list__item"},[(0,o.Wm)(tt,{user:t},null,8,["user"])])))),128))])])),_:1}),(0,o.Wm)(y,{subtitle:"Посты (переход по клику на пост)"},{default:(0,o.w5)((()=>[(0,o.Wm)(he,{id:(0,r.SU)(e)},null,8,["id"])])),_:1})])),_:1}))}};const De=ke;var je=De;const xe=[{name:"Home",path:"/",component:$t},{name:"Friends",path:"/friends",component:ne,beforeEnter:(t,e)=>{if("Home"!==e.name)return{name:"Home"}}},{name:"Friend",path:"/friends/:id",component:je,beforeEnter:(t,e)=>{if("Friends"!==e.name)return{name:"Home"}}}],Le=(0,a.p7)({history:(0,a.PO)({NODE_ENV:"production",BASE_URL:"/"}.BASE_ENV),routes:xe});var Se=Le;(0,s.ri)(l).use(Se).mount("#app")}},e={};function n(s){var o=e[s];if(void 0!==o)return o.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,n),r.exports}n.m=t,function(){var t=[];n.O=function(e,s,o,r){if(!s){var a=1/0;for(c=0;c<t.length;c++){s=t[c][0],o=t[c][1],r=t[c][2];for(var u=!0,i=0;i<s.length;i++)(!1&r||a>=r)&&Object.keys(n.O).every((function(t){return n.O[t](s[i])}))?s.splice(i--,1):(u=!1,r<a&&(a=r));if(u){t.splice(c--,1);var l=o();void 0!==l&&(e=l)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[s,o,r]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,s){var o,r,a=s[0],u=s[1],i=s[2],l=0;if(a.some((function(e){return 0!==t[e]}))){for(o in u)n.o(u,o)&&(n.m[o]=u[o]);if(i)var c=i(n)}for(e&&e(s);l<a.length;l++)r=a[l],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(c)},s=self["webpackChunkbalt_info_test"]=self["webpackChunkbalt_info_test"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(3207)}));s=n.O(s)})();
//# sourceMappingURL=app.5f70f09a.js.map